stages:          # List of stages for jobs, and their order of execution
  - build
  - test

backend_job:       # This job runs in the build stage, which runs first.
  stage: build
  image: maven:latest
  script:
    - cd cine-back/
    - mvn clean package install
  artifacts:
    paths: 
    - cine-back/target/PI-BackEnd-0.0.1-SNAPSHOT.jar
  rules: 
    - changes:
      - cine-back/**/*

frontend_job:
  stage: build
  image: node:16.16.0
  script:
    - cd cine-front/
    - npm install
    - npm run build
  artifacts:
    name: react_dhcinema_build
    paths: 
    - cine-front/build
  rules: 
    - changes: 
      - cine-front/**/*

test_job_back:
  stage: test
  image: maven:latest
  script:
    - cd cine-back/
    - mvn test
  rules: 
    - changes: 
      - cine-back/**/*

test_job_front: 
  stage: test
  image: node:16.16.0
  script:
    - cd cine-front/
    - npm install
    - npm test
  rules: 
    - changes: 
      - cine-front/**/*